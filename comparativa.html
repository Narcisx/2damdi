<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Benchmark LLMs: Dashboard Final</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dark: #0a0a0a;
            --glass-bg: rgba(30, 30, 30, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
            --accent-qwen: #36A2EB;
            --accent-llama: #FF6384;
            --accent-gemma: #4BC0C0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            background-image: 
                radial-gradient(circle at top right, rgba(54, 162, 235, 0.15), transparent 40%),
                radial-gradient(circle at bottom left, rgba(255, 99, 132, 0.15), transparent 40%),
                linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 100%, 100%, 30px 30px, 30px 30px;
            color: #e0e0e0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            overflow-x: hidden;
        }

        h1 {
            font-weight: 800;
            font-size: 2.2rem;
            text-align: center;
            background: linear-gradient(135deg, #fff 30%, var(--accent-qwen));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
            text-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }

        .subtitle { text-align: center; color: #aaa; margin-bottom: 30px; font-weight: 300; }

        .container {
            width: 100%;
            max-width: 900px;
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            padding: 30px;
            border-radius: 24px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            position: relative;
        }
        
        .controls {
            position: relative;
            z-index: 10;
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            justify-content: flex-start;
            flex-wrap: wrap;
        }

        select {
            padding: 12px 20px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            background-color: rgba(20, 20, 20, 0.8);
            color: white;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            outline: none;
            transition: all 0.2s ease;
        }

        select:hover {
            background-color: rgba(50, 50, 50, 1);
            border-color: var(--accent-qwen);
            box-shadow: 0 0 15px rgba(54, 162, 235, 0.2);
        }

        .chart-container {
            position: relative;
            height: 400px; /* Altura fija para evitar saltos */
            width: 100%;
            border-radius: 16px;
            background: rgba(0,0,0,0.2); 
            padding: 15px;
            box-sizing: border-box;
            margin-bottom: 30px;
        }

        /* --- BADGE GANADOR --- */
        #winnerBadge {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(10, 10, 10, 0.9);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 8px 16px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 5;
            pointer-events: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        #winnerBadge.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .trophy-icon { font-size: 1.4rem; }

        .winner-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            line-height: 1;
        }

        .winner-label { font-size: 0.65rem; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px; }
        .winner-name { font-size: 1.1rem; font-weight: 800; letter-spacing: -0.5px; }

        @media (max-width: 650px) {
            .controls { justify-content: center; }
            #winnerBadge { 
                top: auto; 
                bottom: -20px; /* Lo bajamos en m√≥vil */
                left: 50%; 
                right: auto; 
                transform: translate(-50%, 10px); 
                width: max-content;
                z-index: 20;
            }
            #winnerBadge.visible { transform: translate(-50%, 0); }
            .container { padding-bottom: 50px; }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.02);
            padding: 20px;
            border-radius: 16px;
            border: 1px solid var(--glass-border);
            text-align: center;
            transition: transform 0.2s ease;
        }
        
        .stat-card:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.05); }

        .stat-card.qwen { border-bottom: 3px solid var(--accent-qwen); }
        .stat-card.llama { border-bottom: 3px solid var(--accent-llama); }
        .stat-card.gemma { border-bottom: 3px solid var(--accent-gemma); }

        .stat-card small { color: #888; display: block; margin-bottom: 8px; font-size: 0.85rem; }
        .stat-card strong { font-size: 1.4rem; font-weight: 700; color: #eee; }

    </style>
</head>
<body>

    <h1>Comparativa IA</h1>
    <p class="subtitle">Datos de ejecuci√≥n local (Ollama)</p>

    <div class="container">
        
        <div id="winnerBadge">
            <div class="trophy-icon">üèÜ</div>
            <div class="winner-info">
                <span class="winner-label">Ganador actual</span>
                <span class="winner-name" id="badgeName">Cargando...</span>
            </div>
        </div>

        <div class="controls">
            <select id="dataMetric" onchange="renderGlobalChart()">
                <option value="speed">‚ö° Velocidad (Tokens/s)</option>
                <option value="length">üìù Tokens Totales</option>
                <option value="prompt">üß† Velocidad Lectura</option>
                <option value="load">‚è±Ô∏è Tiempo Carga</option>
            </select>

            <select id="chartType" onchange="renderGlobalChart()">
                <option value="bar">üìä Barras</option>
                <option value="line">üìà L√≠neas</option>
                <option value="radar">üï∏Ô∏è Radar</option>
                <option value="doughnut">üç© Donut</option>
            </select>
        </div>

        <div class="chart-container">
            <canvas id="myChart"></canvas>
        </div>

        <div class="stats-grid">
            <div class="stat-card qwen">
                <small>Qwen</small>
                <strong>20.48 t/s</strong>
            </div>
            <div class="stat-card llama">
                <small>Llama</small>
                <strong>18.73 t/s</strong>
            </div>
            <div class="stat-card gemma">
                <small>Gemma</small>
                <strong>910 tokens</strong>
            </div>
        </div>
    </div>

    <script>
        // --- DATOS DUROS ---
        const models = ['Qwen', 'Llama', 'Gemma'];
        const colors = {
            qwen: '#36A2EB',
            llama: '#FF6384',
            gemma: '#4BC0C0'
        };

        const dataSets = {
            speed: { label: 'Velocidad Generaci√≥n (Tokens/s)', data: [20.48, 18.73, 18.57] },
            length: { label: 'Longitud Respuesta (Tokens)', data: [671, 737, 910] },
            prompt: { label: 'Velocidad Prompt (Tokens/s)', data: [171.38, 163.77, 4653.98] },
            load: { label: 'Tiempo de Carga (ms)', data: [356.30, 367.04, 371.80] }
        };

        // Variable global para guardar la instancia del gr√°fico
        let myChartInstance = null;
        let isFirstAnimation = true;

        // --- FUNCI√ìN MAESTRA ---
        function renderGlobalChart() {
            const ctx = document.getElementById('myChart').getContext('2d');
            const metric = document.getElementById('dataMetric').value;
            const type = document.getElementById('chartType').value;
            const currentData = dataSets[metric];

            // 1. SI EXISTE UN GR√ÅFICO, LO DESTRUIMOS (Esto evita el error de desaparici√≥n)
            if (myChartInstance) {
                myChartInstance.destroy();
            }

            // 2. CREAMOS LOS DEGRADADOS (Siempre nuevos para este contexto)
            // Esto es crucial: si no recreas el gradiente, se ve transparente.
            const gradientQwen = ctx.createLinearGradient(0, 0, 0, 400);
            gradientQwen.addColorStop(0, colors.qwen); gradientQwen.addColorStop(1, 'rgba(54, 162, 235, 0.1)');
            
            const gradientLlama = ctx.createLinearGradient(0, 0, 0, 400);
            gradientLlama.addColorStop(0, colors.llama); gradientLlama.addColorStop(1, 'rgba(255, 99, 132, 0.1)');
            
            const gradientGemma = ctx.createLinearGradient(0, 0, 0, 400);
            gradientGemma.addColorStop(0, colors.gemma); gradientGemma.addColorStop(1, 'rgba(75, 192, 192, 0.1)');

            const bgColors = [gradientQwen, gradientLlama, gradientGemma];
            const borderColors = [colors.qwen, colors.llama, colors.gemma];

            // 3. CONFIGURAMOS Y CREAMOS EL NUEVO GR√ÅFICO
            myChartInstance = new Chart(ctx, {
                type: type,
                data: {
                    labels: models,
                    datasets: [{
                        label: currentData.label,
                        data: currentData.data,
                        backgroundColor: bgColors,
                        borderColor: borderColors,
                        borderWidth: 2,
                        // Configuraci√≥n espec√≠fica si es l√≠neas
                        fill: type === 'line' ? 'start' : true,
                        tension: 0.4,
                        pointBackgroundColor: '#fff',
                        pointRadius: 6,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 800, // Duraci√≥n de la animaci√≥n de entrada
                        easing: 'easeOutQuart',
                        onComplete: () => {
                            // Ejecutar l√≥gica de ganador al terminar la animaci√≥n
                            updateWinner(currentData.data, metric);
                            isFirstAnimation = false;
                        }
                    },
                    plugins: {
                        legend: { 
                            display: (type === 'doughnut' || type === 'radar'),
                            labels: { color: '#ccc', font: { family: 'Inter' } } 
                        },
                        tooltip: {
                            backgroundColor: 'rgba(20, 20, 20, 0.9)',
                            titleFont: { size: 14, family: 'Inter' },
                            bodyFont: { size: 14, family: 'Inter' },
                            padding: 12,
                            borderColor: 'rgba(255,255,255,0.1)',
                            borderWidth: 1,
                            displayColors: false
                        }
                    },
                    scales: (type === 'radar' || type === 'doughnut') ? {
                        // Escalas para radar/donut (ocultas o circulares)
                        r: { 
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            angleLines: { color: 'rgba(255,255,255,0.1)' },
                            pointLabels: { color: '#ccc', font: { size: 12 } },
                            ticks: { display: false } // Ocultar n√∫meros del eje radar
                        }
                    } : {
                        // Escalas est√°ndar X/Y
                        y: { 
                            beginAtZero: true, 
                            grid: { color: 'rgba(255, 255, 255, 0.05)', borderDash: [5, 5] },
                            ticks: { color: '#888', font: { family: 'Inter' } }
                        },
                        x: { 
                            grid: { display: false },
                            ticks: { color: '#ddd', font: { weight: '600', family: 'Inter' } }
                        }
                    }
                }
            });
        }

        // --- L√ìGICA DE GANADOR ---
        function updateWinner(dataArray, metric) {
            let winnerIndex = 0;
            
            // Si es tiempo de carga, gana el menor. Si no, el mayor.
            if (metric === 'load') {
                const minVal = Math.min(...dataArray);
                winnerIndex = dataArray.indexOf(minVal);
            } else {
                const maxVal = Math.max(...dataArray);
                winnerIndex = dataArray.indexOf(maxVal);
            }

            const winnerName = models[winnerIndex];
            const winnerColor = Object.values(colors)[winnerIndex];

            // 1. Actualizar Badge HTML
            const badge = document.getElementById('winnerBadge');
            const nameEl = document.getElementById('badgeName');

            nameEl.textContent = winnerName;
            nameEl.style.color = winnerColor;
            badge.style.borderColor = winnerColor;
            badge.style.boxShadow = `0 8px 30px ${winnerColor}40`; // 40 es transparencia hexadecimal
            
            badge.classList.add('visible');

            // 2. Disparar Confeti (Solo si no es la primera carga inicial para no molestar)
            if (!isFirstAnimation) {
                confetti({
                    particleCount: 80,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: [winnerColor, '#ffffff'],
                    disableForReducedMotion: true,
                    zIndex: 100
                });
            }
        }

        // Arrancamos la primera vez
        renderGlobalChart();

    </script>
</body>
</html>